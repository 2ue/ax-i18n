# 提示词模板场景分析与补充

## 分析结果

基于对 `docs/case.md` 文档的详细分析，我发现现有提示词模板的【文本识别规则】部分遗漏了多个重要场景。以下是补充的完整场景列表：

## 补充的场景分类

### 1. 基础字符串处理场景补充

#### 原有场景
- 字符串字面量
- 模板字符串
- 对象属性值
- 数组元素

#### 新增场景
- **字符串拼接**: `const greeting = '你好，' + username + '，欢迎回来！'`
- **嵌套对象属性**: `{user: {profile: {name: "用户名"}}}`
- **数组对象**: `[{id: 1, title: "首页"}]`

### 2. 函数相关场景补充

#### 原有场景
- 函数参数默认值

#### 新增场景
- **解构参数默认值**: `function({name = "匿名用户"} = {}) {}`
- **回调函数参数**: `onSuccess = () => "处理成功"`
- **函数返回值**: `return "操作完成"`
- **构造函数参数**: `constructor(config = {title: "默认标题"}) {}`

### 3. 条件判断场景补充

#### 原有场景
- 条件表达式
- Switch case

#### 新增场景
- **嵌套三元表达式**: `isVip ? (age > 30 ? "资深会员" : "新会员") : "访客"`
- **If条件判断**: `if (userType === "尊贵会员")`
- **逻辑运算符渲染**: `{status === 'loading' && <span>加载中...</span>}` (React)

### 4. 错误处理场景补充

#### 原有场景
- 基础错误抛出

#### 新增场景
- **简单字符串错误**: `throw "系统异常"`
- **模板字符串错误**: `throw new Error(\`请求接口\${api}失败\`)`
- **条件错误消息**: `data ? \`处理\${data.type}时发生错误\` : '未知错误'`

### 5. 异步操作场景补充

#### 原有场景
- 基础异步操作

#### 新增场景
- **异步函数返回值**: `return {success: true, message: "数据加载成功"}`
- **Promise链**: `Promise.resolve("开始加载")`
- **状态对象**: `const status = {pending: "处理中...", success: "处理完成"}`

### 6. React/JSX 特有场景补充

#### 原有场景
- JSX文本节点
- JSX属性值
- 条件渲染

#### 新增场景
- **动态JSX属性**: `<button aria-label={\`编辑 \${user.name}\`} />`
- **React Hook状态**: `const [status, setStatus] = useState("待处理")`
- **useReducer action**: `{type: "登录", payload: user}`
- **表单验证消息**: `{username: "用户名不能为空"}`

### 7. TypeScript 特有场景补充

#### 原有场景
- 枚举值
- 装饰器参数
- 类属性初始值

#### 新增场景
- **方法重载签名**: `function process(type: "文本"): string`
- **泛型约束中的字符串**: `T extends "成功" | "失败"`
- **构造函数参数**: `constructor(private config: {title: string} = {title: "默认标题"}) {}`

### 8. Vue 特有场景补充

#### 原有场景
- 模板文本节点
- 插值表达式
- v-bind属性

#### 新增场景
- **动态属性值**: `<input :placeholder="'请输入'" :title="'标题'" />`
- **模板字符串属性**: `<button :aria-label="\`编辑 \${user.name}\`" />`
- **v-if/v-else中的文本**: `<span v-if="loading">加载中...</span>`
- **v-for中的文本**: `<li v-for="item in ['首页', '产品']">{{ item }}</li>`
- **表单验证规则**: `{required: true, message: "用户名不能为空"}`
- **组件props默认值**: `props: {title: {default: "默认标题"}}`
- **watch中的处理**: `watch: {status(val) { if(val === "error") alert("出错了") }}`

### 9. 常量定义场景补充

#### 原有场景
- 基础常量定义

#### 新增场景
- **复杂映射关系**: `const NODES_TEXT_MAP = {PERFECT_SCHEME: "完善方案"}`
- **操作文本映射**: `const OPERATIONS_TEXT = {AGREE: {SUBMIT: "提交"}}`
- **提示文本映射**: `const TEXTAREA_HINTS = {1: "提交后流程将中止"}`

## 不处理内容的完善

### 原有不处理内容
- 注释中的中文
- console.log等调试语句
- 变量名、函数名

### 新增不处理内容
- **console.log等调试语句的例外**: 除非是用户消息
- **CSS类名和样式值**
- **正则表达式**
- **URL和API端点**
- **配置键名**: 对象的key，除非是显示文本
- **JSON字符串中的键名**
- **事件名称**
- **CSS选择器**
- **HTML标签名**
- **属性名称**: 除非是显示文本
- **ref属性值**
- **key属性值**: 除非是显示文本

## 场景覆盖度分析

### 覆盖的主要场景类别
1. ✅ 基础字符串处理 (完整覆盖)
2. ✅ React/JSX 场景 (完整覆盖)
3. ✅ TypeScript 特有场景 (完整覆盖)
4. ✅ 复杂场景处理 (完整覆盖)
5. ✅ Vue 特有场景 (完整覆盖)
6. ✅ 错误处理场景 (完整覆盖)
7. ✅ 异步和Promise场景 (完整覆盖)
8. ✅ 常量定义场景 (完整覆盖)
9. ✅ React Hooks 场景 (完整覆盖)

### 特殊考虑的场景
- **注释处理**: 默认不处理，但支持配置
- **调试语句**: 默认不处理，但用户消息例外
- **类型定义**: TypeScript中的字符串字面量类型需要谨慎处理
- **动态内容**: 包含变量插值的复杂字符串
- **嵌套结构**: 多层嵌套的对象和数组

## 模板质量提升

### 1. 场景完整性
- 从原来的 9 个基础场景扩展到 30+ 个详细场景
- 覆盖了 case.md 中提到的所有主要场景类型
- 包含了边界情况和特殊场景

### 2. 精确性提升
- 明确区分了"函数参数默认值"和"回调函数参数"
- 细分了不同类型的条件判断场景
- 区分了不同类型的错误处理方式

### 3. 框架特异性
- React: 增加了 Hook、事件处理、表单验证等场景
- Vue: 增加了指令、组件通信、表单验证等场景
- TypeScript: 增加了类型系统相关的特殊场景

### 4. 实用性增强
- 基于真实项目中的常见场景
- 考虑了开发者的实际使用习惯
- 包含了现代前端开发的最佳实践

## 结论

通过这次全面的场景分析和补充，提示词模板现在能够：

1. **更准确地识别**需要国际化的文本
2. **更精确地区分**不同场景的处理方式
3. **更全面地覆盖**各种框架和语言特性
4. **更好地指导**大模型进行文本提取和代码转换

这些改进将显著提高 i18n-xy 工具的处理准确性和覆盖范围。