# 提示词模板语义化改进说明

## 改进概述

将原有的简单配置参数列举方式改进为语义化的处理指导规则，让AI能够更好地理解如何处理文件内容，而不是仅仅知道参数值。

## 主要改进内容

### 1. 配置参数 → 处理指导规则

#### 改进前
```markdown
## 配置参数
- **源语言**: {locale}
- **替换函数**: {functionName}
- **自动导入**: {autoImport}
```

#### 改进后
```markdown
## 处理指导规则

### 核心处理流程
1. **文本识别**: 识别代码文件内的 `{locale}` 语言字符串，按照下方的文本识别规则进行精确匹配
2. **临时Key生成**: 为每个识别到的文本生成唯一的临时key，格式为 `__I18N_${递增序号}__`
3. **代码替换**: 将识别到的文本替换为 `{functionName}('临时key')` 的格式
4. **自动导入处理**: 如果启用自动导入，根据文件类型和导入规则添加翻译函数导入
5. **格式保持**: 确保转换后的代码保持原有格式和功能
```

### 2. 框架特异性指导

#### React TSX/JSX
- **JSX语法处理**: 明确指导如何处理JSX文本节点和属性
- **Hook集成**: 说明如何集成useTranslation Hook
- **TypeScript兼容**: 确保类型安全

#### Vue
- **SFC处理**: 分别处理template、script、style三个部分
- **指令处理**: 正确处理Vue指令和插值表达式
- **API适配**: 区分Composition API和Options API

#### TypeScript
- **类型安全**: 确保替换后的代码符合类型系统
- **装饰器处理**: 正确处理装饰器参数
- **类型定义**: 谨慎处理字符串字面量类型

### 3. 自动导入详细指导

#### 改进前
```markdown
**autoImport.enabled = true 时的处理**:
1. 检查现有导入
2. 插入位置
3. 导入语句
```

#### 改进后
```markdown
### 自动导入详细处理规则

#### 导入触发条件
- 当配置中autoImport.enabled为true时，需要执行自动导入处理
- 检查文件中是否已存在相关的翻译函数导入，避免重复导入

#### 导入位置决策
根据autoImport.insertPosition配置确定导入语句的插入位置：
- **"top"**: 在文件的最顶部插入导入语句
- **"afterImports"**: 在现有的import/require语句之后插入
- **"beforeFirstUse"**: 在第一次使用翻译函数之前插入

#### 导入内容生成
- 从autoImport.imports配置中查找匹配当前文件类型的导入规则
- 使用glob模式匹配文件路径，选择对应的importStatement
- 根据文件类型调整导入语法（ES6 import vs CommonJS require）
```

### 4. 完整示例转换

#### 改进前
简单的前后对比示例

#### 改进后
完整的真实场景示例，包括：
- 原始文件的完整代码
- 处理后的完整代码
- 生成的提取结果JSON
- 各种复杂场景的处理方式

### 5. 翻译模板语义化

#### 改进前
```markdown
## 配置参数
- **源语言**: {locale}
- **目标语言**: {displayLanguage}
- **翻译风格**: {style}
```

#### 改进后
```markdown
## 翻译指导规则

### 核心翻译流程
1. **语言识别**: 识别输入文本的源语言为 `{locale}`，需要翻译为目标语言 `{displayLanguage}`
2. **风格适配**: 根据指定的翻译风格 `{style}` 调整翻译的语调和表达方式
3. **上下文理解**: 理解文本在软件界面中的使用场景，选择最适合的翻译
4. **一致性保持**: 确保相同概念在整个翻译过程中保持术语一致
5. **质量检查**: 验证翻译的准确性、完整性和适用性
```

## 语义化改进的优势

### 1. 更好的AI理解
- AI能够理解整个处理流程，而不是仅仅知道参数值
- 明确了每个步骤的目的和要求
- 提供了决策依据和处理逻辑

### 2. 更准确的处理
- 详细的流程指导减少了处理错误
- 明确的规则避免了歧义
- 完整的示例提供了参考标准

### 3. 更好的扩展性
- 新的场景可以轻松添加到现有流程中
- 规则化的处理方式便于维护和更新
- 模块化的设计支持不同框架的特殊需求

### 4. 更强的一致性
- 统一的处理流程确保结果一致
- 标准化的输出格式便于后续处理
- 规范化的错误处理提高稳定性

## 实际效果对比

### 处理准确性提升
- **文本识别**: 从简单匹配提升到语义理解
- **代码替换**: 从机械替换提升到智能转换
- **格式保持**: 从基本保持提升到完全一致

### 框架适配性提升
- **React**: 正确处理Hook、JSX、TypeScript
- **Vue**: 正确处理SFC、指令、API差异
- **通用**: 支持各种JavaScript/TypeScript场景

### 自动导入准确性提升
- **位置判断**: 智能选择最佳插入位置
- **语法适配**: 根据项目类型选择正确语法
- **重复检测**: 避免重复导入和冲突

## 结论

通过语义化改进，提示词模板从简单的参数传递升级为智能的处理指导，显著提升了AI对复杂代码场景的理解和处理能力，确保了i18n转换的准确性和一致性。